# 重构与优化路线图（阶段规划）

面向 SMB1 风格致敬实现，结合现状与差异清单，给出阶段化路线图。每个阶段保持“可运行可演示”，严格中文注释。

## 阶段 A：稳定与表现
- [ ] 旗杆滑落与结算演出（时间换分动画、提示文案）。
- [ ] 角色/敌人动画集：站立/起跑/急停/空中、壳滑粒子、击杀火花。
- [ ] 音频系统升级：BGM 循环、倒计时加速、事件音优先级与节流。
- [ ] 摄像机平滑与限制（减少抖动、边缘缓冲）。

## 阶段 B：关卡主题扩展
- [ ] 水下主题：游泳控制（浮力/拍腿）、水下敌人（Cheep Cheep、Blooper）。
- [ ] 城堡主题：Fire Bar、火焰喷口、桥/斧头演出，简单 Boss 桥收尾。
- [ ] 自动卷轴与移动平台集合（水平/垂直/摆动）。
- [ ] 隐藏砖/多金币砖（计时多金币）、1UP 逻辑。

## 阶段 C：敌人与道具
- [ ] Piranha Plant（管道），Lakitu/Spiny，Hammer Bro，Bullet Bill（炮台）。
- [ ] Fire Flower（火球路径反弹/地面弹跳），龟壳与砖/敌的更多交互（连击计分）。
- [ ] Vine（藤蔓）触发与纵向房间。

## 阶段 D：系统化与数据化
- [ ] 关卡数据结构重构：多房间/子区域、多主题背景/配色。
- [ ] 关卡/实体参数 JSON 化，热加载调试辅助（Dev 面板）。
- [ ] 可选生命制与 Continue，Checkpoint（中途旗）。
- [ ] 最终世界结构（如 1-1~1-4 × N），Warp Zone 规则。

## 阶段 E：工具与质量
- [ ] 轻量关卡编辑工具（浏览器内绘图+导出）。
- [ ] 单元测试：碰撞/道具/计分；渲染快照；CI 集成。
- [ ] 性能优化：可见性裁剪、对象池、时间步自适应（保底 60fps）。

优先级建议：A → B → C → D → E；每阶段可拆分为多次小提交。

